<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Statistics | UMass PBS Instructors R Manual</title>
  <meta name="description" content="A guide for instructors teaching statistics and research methods with R in the UMass Amherst Psychological &amp; Brain Sciences Department." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Statistics | UMass PBS Instructors R Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide for instructors teaching statistics and research methods with R in the UMass Amherst Psychological &amp; Brain Sciences Department." />
  <meta name="github-repo" content="wjhopper/PBS-R-Manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Statistics | UMass PBS Instructors R Manual" />
  
  <meta name="twitter:description" content="A guide for instructors teaching statistics and research methods with R in the UMass Amherst Psychological &amp; Brain Sciences Department." />
  

<meta name="author" content="Andrea Cataldo &amp; Will Hopper" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-programming-fundamentals.html">
<link rel="next" href="tools-advice-for-instructors.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">UMass PBS Instructors R Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-r-language"><i class="fa fa-check"></i>The R Language</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formatting-conventions"><i class="fa fa-check"></i>Formatting Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#additional-materials"><i class="fa fa-check"></i>Additional Materials</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introducing R and RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#console"><i class="fa fa-check"></i><b>1.1</b> Pane #1: The R Console</a></li>
<li class="chapter" data-level="1.2" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#pane-2-the-editor"><i class="fa fa-check"></i><b>1.2</b> Pane #2: The Editor</a></li>
<li class="chapter" data-level="1.3" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#pane-3-your-r-session"><i class="fa fa-check"></i><b>1.3</b> Pane #3: Your R Session</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#variables-and-the-environment"><i class="fa fa-check"></i><b>1.3.1</b> Variables and the Environment</a></li>
<li class="chapter" data-level="1.3.2" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#history"><i class="fa fa-check"></i><b>1.3.2</b> History</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#pane-4-miscellaneous"><i class="fa fa-check"></i><b>1.4</b> Pane #4: Miscellaneous</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#plots"><i class="fa fa-check"></i><b>1.4.1</b> Plots</a></li>
<li class="chapter" data-level="1.4.2" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#packages"><i class="fa fa-check"></i><b>1.4.2</b> Packages</a></li>
<li class="chapter" data-level="1.4.3" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#help"><i class="fa fa-check"></i><b>1.4.3</b> Help</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introducing-r-and-rstudio.html"><a href="introducing-r-and-rstudio.html#conclusion"><i class="fa fa-check"></i><b>1.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html"><i class="fa fa-check"></i><b>2</b> R Programming Fundamentals</a><ul>
<li class="chapter" data-level="2.1" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#classes-of-data"><i class="fa fa-check"></i><b>2.1</b> Classes of Data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#the-numeric-class"><i class="fa fa-check"></i><b>2.1.1</b> The Numeric Class</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#the-integer-class"><i class="fa fa-check"></i><b>2.1.2</b> The Integer Class</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#logicals"><i class="fa fa-check"></i><b>2.1.3</b> The Logical Class</a></li>
<li class="chapter" data-level="2.1.4" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#the-character-class"><i class="fa fa-check"></i><b>2.1.4</b> The Character Class</a></li>
<li class="chapter" data-level="2.1.5" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#factors"><i class="fa fa-check"></i><b>2.1.5</b> Factors</a></li>
<li class="chapter" data-level="2.1.6" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#class-detection-and-conversion"><i class="fa fa-check"></i><b>2.1.6</b> Class detection and conversion</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#data-structures"><i class="fa fa-check"></i><b>2.2</b> Data Structures</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#vectors"><i class="fa fa-check"></i><b>2.2.1</b> Vectors</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#matrices"><i class="fa fa-check"></i><b>2.2.2</b> Matrices</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#data-frames"><i class="fa fa-check"></i><b>2.2.3</b> Data Frames</a></li>
<li class="chapter" data-level="2.2.4" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#lists"><i class="fa fa-check"></i><b>2.2.4</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#operators"><i class="fa fa-check"></i><b>2.3</b> Operators</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#relational-operators"><i class="fa fa-check"></i><b>2.3.1</b> Relational Operators</a></li>
<li class="chapter" data-level="2.3.2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#logical-operators"><i class="fa fa-check"></i><b>2.3.2</b> Logical Operators</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#functions"><i class="fa fa-check"></i><b>2.4</b> Functions</a><ul>
<li class="chapter" data-level="2.4.1" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#description"><i class="fa fa-check"></i><b>2.4.1</b> Description</a></li>
<li class="chapter" data-level="2.4.2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#usage"><i class="fa fa-check"></i><b>2.4.2</b> Usage</a></li>
<li class="chapter" data-level="2.4.3" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#arguments"><i class="fa fa-check"></i><b>2.4.3</b> Arguments</a></li>
<li class="chapter" data-level="2.4.4" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#named-vs.-unnamed-arguments"><i class="fa fa-check"></i><b>2.4.4</b> Named vs. Unnamed Arguments</a></li>
<li class="chapter" data-level="2.4.5" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#a-word-of-advice-2"><i class="fa fa-check"></i><b>2.4.5</b> A Word of Advice</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#data-manipulation"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a><ul>
<li class="chapter" data-level="2.5.1" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#tidy-data"><i class="fa fa-check"></i><b>2.5.1</b> Tidy Data</a></li>
<li class="chapter" data-level="2.5.2" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#importing-data"><i class="fa fa-check"></i><b>2.5.2</b> Importing Data</a></li>
<li class="chapter" data-level="2.5.3" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#subsetting"><i class="fa fa-check"></i><b>2.5.3</b> Subsetting</a></li>
<li class="chapter" data-level="2.5.4" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#indexing"><i class="fa fa-check"></i><b>2.5.4</b> Indexing</a></li>
<li class="chapter" data-level="2.5.5" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#replacement"><i class="fa fa-check"></i><b>2.5.5</b> Replacement</a></li>
<li class="chapter" data-level="2.5.6" data-path="r-programming-fundamentals.html"><a href="r-programming-fundamentals.html#matrices-data-frames"><i class="fa fa-check"></i><b>2.5.6</b> Matrices &amp; Data Frames</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>3</b> Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="statistics.html"><a href="statistics.html#the-data"><i class="fa fa-check"></i><b>3.1</b> The Data</a></li>
<li class="chapter" data-level="3.2" data-path="statistics.html"><a href="statistics.html#formula-objects"><i class="fa fa-check"></i><b>3.2</b> Formula Objects</a></li>
<li class="chapter" data-level="3.3" data-path="statistics.html"><a href="statistics.html#descriptive-statistics"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="3.3.1" data-path="statistics.html"><a href="statistics.html#mean"><i class="fa fa-check"></i><b>3.3.1</b> Mean</a></li>
<li class="chapter" data-level="3.3.2" data-path="statistics.html"><a href="statistics.html#median"><i class="fa fa-check"></i><b>3.3.2</b> Median</a></li>
<li class="chapter" data-level="3.3.3" data-path="statistics.html"><a href="statistics.html#variance"><i class="fa fa-check"></i><b>3.3.3</b> Variance</a></li>
<li class="chapter" data-level="3.3.4" data-path="statistics.html"><a href="statistics.html#standard-deviation"><i class="fa fa-check"></i><b>3.3.4</b> Standard Deviation</a></li>
<li class="chapter" data-level="3.3.5" data-path="statistics.html"><a href="statistics.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>3.3.5</b> Standard Error of the Mean</a></li>
<li class="chapter" data-level="3.3.6" data-path="statistics.html"><a href="statistics.html#correlation-proportion-of-variance-explained"><i class="fa fa-check"></i><b>3.3.6</b> Correlation &amp; Proportion of Variance Explained</a></li>
<li class="chapter" data-level="3.3.7" data-path="statistics.html"><a href="statistics.html#summary-functions"><i class="fa fa-check"></i><b>3.3.7</b> Summary Functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="statistics.html"><a href="statistics.html#plotting"><i class="fa fa-check"></i><b>3.4</b> Plotting</a><ul>
<li class="chapter" data-level="3.4.1" data-path="statistics.html"><a href="statistics.html#scatter-line-plots"><i class="fa fa-check"></i><b>3.4.1</b> Scatter &amp; Line Plots</a></li>
<li class="chapter" data-level="3.4.2" data-path="statistics.html"><a href="statistics.html#histograms"><i class="fa fa-check"></i><b>3.4.2</b> Histograms</a></li>
<li class="chapter" data-level="3.4.3" data-path="statistics.html"><a href="statistics.html#boxplots"><i class="fa fa-check"></i><b>3.4.3</b> Boxplots</a></li>
<li class="chapter" data-level="3.4.4" data-path="statistics.html"><a href="statistics.html#bar-plots"><i class="fa fa-check"></i><b>3.4.4</b> Bar plots</a></li>
<li class="chapter" data-level="3.4.5" data-path="statistics.html"><a href="statistics.html#multiple-plots-in-single-figure"><i class="fa fa-check"></i><b>3.4.5</b> Multiple plots in single figure</a></li>
<li class="chapter" data-level="3.4.6" data-path="statistics.html"><a href="statistics.html#saving-plots"><i class="fa fa-check"></i><b>3.4.6</b> Saving Plots</a></li>
<li class="chapter" data-level="3.4.7" data-path="statistics.html"><a href="statistics.html#what-about-ggplot"><i class="fa fa-check"></i><b>3.4.7</b> What about ggplot?</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="statistics.html"><a href="statistics.html#inferential-statistics"><i class="fa fa-check"></i><b>3.5</b> Inferential Statistics</a><ul>
<li class="chapter" data-level="3.5.1" data-path="statistics.html"><a href="statistics.html#distribution-functions"><i class="fa fa-check"></i><b>3.5.1</b> Distribution Functions</a></li>
<li class="chapter" data-level="3.5.2" data-path="statistics.html"><a href="statistics.html#confidence-intervals"><i class="fa fa-check"></i><b>3.5.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="3.5.3" data-path="statistics.html"><a href="statistics.html#t.test"><i class="fa fa-check"></i><b>3.5.3</b> <code>t.test()</code></a></li>
<li class="chapter" data-level="3.5.4" data-path="statistics.html"><a href="statistics.html#aov"><i class="fa fa-check"></i><b>3.5.4</b> <code>aov()</code></a></li>
<li class="chapter" data-level="3.5.5" data-path="statistics.html"><a href="statistics.html#cor.test"><i class="fa fa-check"></i><b>3.5.5</b> <code>cor.test()</code></a></li>
<li class="chapter" data-level="3.5.6" data-path="statistics.html"><a href="statistics.html#binom.test"><i class="fa fa-check"></i><b>3.5.6</b> <code>binom.test()</code></a></li>
<li class="chapter" data-level="3.5.7" data-path="statistics.html"><a href="statistics.html#chisq.test"><i class="fa fa-check"></i><b>3.5.7</b> <code>chisq.test()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html"><i class="fa fa-check"></i><b>4</b> Tools &amp; Advice for Instructors</a><ul>
<li class="chapter" data-level="4.1" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#best-practices"><i class="fa fa-check"></i><b>4.1</b> Best Practices</a><ul>
<li class="chapter" data-level="4.1.1" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#commands-vs.-buttons"><i class="fa fa-check"></i><b>4.1.1</b> Commands vs. Buttons</a></li>
<li class="chapter" data-level="4.1.2" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#naming-objects"><i class="fa fa-check"></i><b>4.1.2</b> Naming Objects</a></li>
<li class="chapter" data-level="4.1.3" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#scripting"><i class="fa fa-check"></i><b>4.1.3</b> Scripting</a></li>
<li class="chapter" data-level="4.1.4" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#formatting-requirements-for-assignments"><i class="fa fa-check"></i><b>4.1.4</b> Formatting Requirements for Assignments</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#error-messages"><i class="fa fa-check"></i><b>4.2</b> Error Messages</a><ul>
<li><a href="tools-advice-for-instructors.html#there-is-no-output-from-a-command-and-there-is-a-in-the-console-instead-of-a-.">There is no output from a command, and there is a <code>+</code> in the console instead of a <code>&gt;</code>.</a></li>
<li><a href="tools-advice-for-instructors.html#error-unexpected-in-___"><code>Error: unexpected ')' in '___'</code></a></li>
<li><a href="tools-advice-for-instructors.html#error-object-___-not-found"><code>Error: Object '___' not found</code></a></li>
<li><a href="tools-advice-for-instructors.html#error-in-___-non-numeric-argument-to-binary-operator"><code>Error in ___ : non-numeric argument to binary operator</code></a></li>
<li><a href="tools-advice-for-instructors.html#error-in-___x-could-not-find-function-___"><code>Error in ___(x) : could not find function '___'</code></a></li>
<li><a href="tools-advice-for-instructors.html#error-in-___-cannot-open-the-connection"><code>Error in ___ : cannot open the connection</code></a></li>
<li><a href="tools-advice-for-instructors.html#error-in-___-undefined-columns-selected-or-error-in-___-subscript-out-of-bounds"><code>Error in ___ : undefined columns selected** or **Error in ___: subscript out of bounds</code></a></li>
<li><a href="tools-advice-for-instructors.html#error-unexpected-symbol-in-___"><code>Error: unexpected symbol in '___'</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#data-sets"><i class="fa fa-check"></i><b>4.3</b> Data Sets</a><ul>
<li class="chapter" data-level="4.3.1" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#how-to-handle-na-values"><i class="fa fa-check"></i><b>4.3.1</b> How to Handle <code>NA</code> Values</a></li>
<li class="chapter" data-level="4.3.2" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#built-in"><i class="fa fa-check"></i><b>4.3.2</b> Built-In</a></li>
<li class="chapter" data-level="4.3.3" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#fivethirtyeight"><i class="fa fa-check"></i><b>4.3.3</b> FiveThirtyEight</a></li>
<li class="chapter" data-level="4.3.4" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#psych"><i class="fa fa-check"></i><b>4.3.4</b> psych</a></li>
<li class="chapter" data-level="4.3.5" data-path="tools-advice-for-instructors.html"><a href="tools-advice-for-instructors.html#simulating-your-own-data-sets"><i class="fa fa-check"></i><b>4.3.5</b> Simulating your own Data Sets</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">UMass PBS Instructors R Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Statistics</h1>
<div id="the-data" class="section level2">
<h2><span class="header-section-number">3.1</span> The Data</h2>
<p>We rely on the <code>sat.act</code> data set from the <code>psych</code> package for all demonstrations in this chapter.</p>
<p>To make the data set available on your own computer, run the following code:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&#39;psych&#39;</span>)
<span class="kw">library</span>(psych)</code></pre>
<p>You should now be able to access the <code>sat.act</code> data set:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sat.act)</code></pre>
<pre><code>##      gender        education          age             ACT       
##  Min.   :1.000   Min.   :0.000   Min.   :13.00   Min.   : 3.00  
##  1st Qu.:1.000   1st Qu.:3.000   1st Qu.:19.00   1st Qu.:25.00  
##  Median :2.000   Median :3.000   Median :22.00   Median :29.00  
##  Mean   :1.647   Mean   :3.164   Mean   :25.59   Mean   :28.55  
##  3rd Qu.:2.000   3rd Qu.:4.000   3rd Qu.:29.00   3rd Qu.:32.00  
##  Max.   :2.000   Max.   :5.000   Max.   :65.00   Max.   :36.00  
##                                                                 
##       SATV            SATQ      
##  Min.   :200.0   Min.   :200.0  
##  1st Qu.:550.0   1st Qu.:530.0  
##  Median :620.0   Median :620.0  
##  Mean   :612.2   Mean   :610.2  
##  3rd Qu.:700.0   3rd Qu.:700.0  
##  Max.   :800.0   Max.   :800.0  
##                  NA&#39;s   :13</code></pre>
<p>As you can see, this data set includes self-reported SAT and ACT scores along with demographic information from 700 respondents. It therefore contains both categorical and continuous variables that are appropriate for both within- and between-subjects analyses. For more information, refer to the help documentation by running the command <code>?sat.act</code>.</p>
</div>
<div id="formula-objects" class="section level2">
<h2><span class="header-section-number">3.2</span> Formula Objects</h2>
<p>Formulas are special objects in R that are used in a range of functions discussed in this chapter, notably <code>plot()</code>, <code>aov()</code>, and <code>lm()</code>. The use of formulas in these specific functions will be discussed in more detail below, but we first introduce their general properties here.</p>
<p>The basic structure is as follows:</p>
<p><code>y ~ x</code></p>
<p>The <code>y</code> variable is the dependent variable, the <code>x</code> variable is the independent variable, and the <code>~</code> operator can be taken to mean “as a function of”. Thus, the above example is a formula for “y as a function of x”.</p>
<p>For a more concrete example, consider the effect of the independent variable age on the dependent variable ACT scores:</p>
<p><code>sat.act$ACT ~ sat.act$age</code></p>
<p>We can have multiple independent variables in the formula. For instance, if we wanted to define ACT scores as a function of age and education, we would do so as follows:</p>
<p><code>sat.act$ACT ~ sat.act$age + sat.act$education</code></p>
<p>The above formula is an example of an “additive” model, in which ACT scores are a function of the additive effects of age and education. To define the interactive model, we would separate age and education by an asterisk instead of a plus sign:</p>
<p><code>sat.act$ACT ~ sat.act$age*sat.act$education</code></p>
<p>Note that the above formula defines the <em>full</em> interactive model, so ACT scores are defined as a function of (1) the main effect of age, (2) the main effect of education, and (3) the interaction of age and education. This same model can be implemented by defining each component separately in the formula object, like this:</p>
<p><code>sat.act$ACT ~ sat.act$age + sat.act$education + sat.act$age:sat.act$education</code></p>
<p>By defining the components separately, you can pick and choose which to keep. For instance, you could specify only the main effect of age and the interaction of age and education, as follows:</p>
<p><code>sat.act$ACT ~ sat.act$age + sat.act$age:sat.act$education</code></p>
<p>Formulas can get much more complex than the examples here, which only extend as far necessary for the functions and tests that you are likely to use as an instructor in undergraduate psychology program. A comprehensive tutorial can be found <a href="https://www.datacamp.com/community/tutorials/r-formula-tutorial">here</a>.</p>
</div>
<div id="descriptive-statistics" class="section level2">
<h2><span class="header-section-number">3.3</span> Descriptive Statistics</h2>
<div id="mean" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Mean</h3>
<p>To calculate the mean of a vector by hand, use the <code>sum()</code> and <code>length()</code> functions. For instance, we can calculate the mean verbal SAT score in the <code>sat.act</code> data set as follows:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(sat.act<span class="op">$</span>SATV)<span class="op">/</span><span class="kw">length</span>(sat.act<span class="op">$</span>SATV)</code></pre>
<pre><code>## [1] 612.2343</code></pre>
<p>We can also get the same answer by using the <code>mean()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(sat.act<span class="op">$</span>SATV)</code></pre>
<pre><code>## [1] 612.2343</code></pre>
<p>Note that <code>NA</code> values can be removed from the vector when using the <code>mean()</code> function by setting the <code>na.rm</code> argument to <code>TRUE</code>. For instance, when we try to take the mean of the quantitative SAT scores without removing <code>NA</code> values, we get <code>NA</code> as the output:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(sat.act<span class="op">$</span>SATQ)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>But by setting <code>na.rm=TRUE</code>, we get a sensible answer:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(sat.act<span class="op">$</span>SATQ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 610.2169</code></pre>
<p>The <code>NA</code> values cannot be removed this easily when calculating the mean by hand because while the <code>sum()</code> function will take the <code>na.rm</code> argument, the <code>length()</code> function will not. Thus, if you plan to ask students to calculate the mean by hand in R, be sure to choose a method of removing NA values manually. You can either remove the values yourself beforehand, give the students code to do it, or teach them to look out for and handle <code>NA</code> values themselves.</p>
</div>
<div id="median" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Median</h3>
<p>You can ask students to calculate the median of a vector by hand by having them index the output of the <code>sort()</code> function. To demonstrate, imagine that we want to know the median age of respondents in the <code>sat.act</code> data set. Calling <code>sort()</code> function on the <code>age</code> variable will take all of the respondents’ ages and put them in ascending order:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(sat.act<span class="op">$</span>age)</code></pre>
<pre><code>##   [1] 13 14 15 15 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 17
##  [24] 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17 17
##  [47] 17 17 17 17 17 17 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18
##  [70] 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18
##  [93] 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18
## [116] 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 19 19 19
## [139] 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19
## [162] 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19
## [185] 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19
## [208] 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 19 20 20 20 20 20
## [231] 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
## [254] 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
## [277] 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 21 21 21 21 21 21 21
## [300] 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21 21
## [323] 21 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22
## [346] 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 22 23 23 23 23
## [369] 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23
## [392] 23 23 23 23 23 23 23 23 23 23 23 23 24 24 24 24 24 24 24 24 24 24 24
## [415] 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 25 25 25 25 25 25
## [438] 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 26
## [461] 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 27 27
## [484] 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 28 28 28 28 28 28
## [507] 28 28 28 28 28 28 28 28 28 28 28 28 28 29 29 29 29 29 29 29 29 29 29
## [530] 29 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 31 31 31 31
## [553] 31 31 31 31 31 32 32 32 32 32 33 33 33 33 33 33 33 33 33 33 34 34 34
## [576] 34 34 34 34 34 34 34 34 34 34 34 34 35 35 35 35 35 35 35 35 35 35 35
## [599] 35 35 36 36 36 36 36 36 36 36 36 36 37 37 37 37 37 37 37 37 37 37 37
## [622] 38 38 38 38 38 38 38 39 39 39 40 40 40 40 40 40 40 40 40 41 41 41 41
## [645] 42 42 42 42 43 43 43 43 43 43 43 44 44 44 44 44 44 45 45 46 46 46 46
## [668] 47 48 48 49 50 50 50 50 50 52 52 52 53 53 54 54 55 55 55 55 56 57 57
## [691] 57 57 57 58 58 58 61 61 62 65</code></pre>
<p>We can then find the median by indexing the middle value of the sorted vector. If the vector has an odd number of values, this is simply half of the length of the vector plus .5:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(sat.act<span class="op">$</span>age)[(<span class="kw">length</span>(sat.act<span class="op">$</span>age)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span>.<span class="dv">5</span>]</code></pre>
<p>Of course, there are 700 respondents in the <code>sat.act</code> data set, so the above command is not appropriate. When the vector has an even number of values like ours, the median is calculated as the average of the two middle values:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the two middle values</span>
middle_vals &lt;-<span class="st"> </span><span class="kw">sort</span>(sat.act<span class="op">$</span>age)[(<span class="kw">length</span>(sat.act<span class="op">$</span>age)<span class="op">/</span><span class="dv">2</span>)<span class="op">:</span>((<span class="kw">length</span>(sat.act<span class="op">$</span>age)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span>)]

<span class="co"># Take the mean of the two middle values</span>
<span class="kw">mean</span>(middle_vals)</code></pre>
<pre><code>## [1] 22</code></pre>
<p>Note that you might also allow students to simply print the output of <code>sort()</code> and find the median visually.</p>
<p>We can also get the same answer by using the <code>median()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(sat.act<span class="op">$</span>age)</code></pre>
<pre><code>## [1] 22</code></pre>
<p>Note that <code>NA</code> values can be removed from the vector when using the <code>median()</code> function by setting the <code>na.rm</code> argument to <code>TRUE</code>. For instance, when we try to take the median of the quantitative SAT scores without removing <code>NA</code> values, we get <code>NA</code> as the output:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(sat.act<span class="op">$</span>SATQ)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>But by setting <code>na.rm=TRUE</code>, we get a sensible answer:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(sat.act<span class="op">$</span>SATQ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 620</code></pre>
<p>The <code>NA</code> values are automatically removed when calculating the median by hand using the <code>sort()</code> function, however you can also choose to have missing values placed last or first in the output by setting the <code>na.last</code> argument to ‘TRUE’ or ‘FALSE’, respectively.</p>
</div>
<div id="variance" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Variance</h3>
<p>Calculating the variance by hand requires more distinct sequencing than for the mean and the median. To demonstrate, imagine that we want to find the variance of the verbal SAT scores reported in the <code>sat.act</code> data set.</p>
<p>Recall from your knowledge of statistics that the formula for the variance of a sample is:</p>
<p><span class="math display">\[s^2=\frac{\sum (x_i-\bar{x})^2}{n-1}\]</span></p>
<p>You might first have students find the squared difference between each value and the mean:</p>
<pre class="sourceCode r"><code class="sourceCode r">SATV_sq_diff &lt;-<span class="st"> </span>(sat.act<span class="op">$</span>SATV<span class="op">-</span><span class="kw">mean</span>(sat.act<span class="op">$</span>SATV))<span class="op">^</span><span class="dv">2</span></code></pre>
<p>You can then have students sum up these squared deviations and divide by the total number, minus one:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(SATV_sq_diff)<span class="op">/</span>(<span class="kw">length</span>(SATV_sq_diff)<span class="op">-</span><span class="dv">1</span>)</code></pre>
<pre><code>## [1] 12746.99</code></pre>
<p>We can also get the same answer by using the <code>var()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(sat.act<span class="op">$</span>SATV)</code></pre>
<pre><code>## [1] 12746.99</code></pre>
<p>Note that <code>NA</code> values can be removed from the vector when using the <code>var()</code> function by setting the <code>na.rm</code> argument to <code>TRUE</code>. For instance, when we try to take the variance of the quantitative SAT scores without removing <code>NA</code> values, we get <code>NA</code> as the output:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(sat.act<span class="op">$</span>SATQ)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>But by setting <code>na.rm=TRUE</code>, we get a sensible answer:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(sat.act<span class="op">$</span>SATQ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 13372.45</code></pre>
<p>The <code>NA</code> values cannot be removed this easily when calculating the variance by hand because while the <code>sum()</code> function will take the <code>na.rm</code> argument, the <code>length()</code> function will not. Thus, if you plan to ask students to calculate the variance by hand in R, be sure to choose a method of removing NA values manually. You can either remove the values yourself beforehand, give the students code to do it, or teach them to look out for and handle <code>NA</code> values themselves.</p>
</div>
<div id="standard-deviation" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Standard Deviation</h3>
<p>To calculate the standard deviation by hand, simply extend the previous commands for calculating the variance one step further by calling <code>sqrt()</code> on the previous result:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the squared deviations</span>
SATV_sq_diff &lt;-<span class="st"> </span>(sat.act<span class="op">$</span>SATV<span class="op">-</span><span class="kw">mean</span>(sat.act<span class="op">$</span>SATV))<span class="op">^</span><span class="dv">2</span>

<span class="co"># Sum squared deviations and divide by n-1</span>
SATV_var &lt;-<span class="st"> </span><span class="kw">sum</span>(SATV_sq_diff)<span class="op">/</span>(<span class="kw">length</span>(SATV_sq_diff)<span class="op">-</span><span class="dv">1</span>)

<span class="co"># Take the square root</span>
<span class="kw">sqrt</span>(SATV_var)</code></pre>
<pre><code>## [1] 112.9026</code></pre>
<p>More simply, students could take the square root of the output of <code>var()</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(<span class="kw">var</span>(sat.act<span class="op">$</span>SATV))</code></pre>
<pre><code>## [1] 112.9026</code></pre>
<p>Note that the square root of a value can also be found by raising it to .5:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(sat.act<span class="op">$</span>SATV)<span class="op">^</span>.<span class="dv">5</span></code></pre>
<pre><code>## [1] 112.9026</code></pre>
<p>We can also get the same answer by using the <code>sd()</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(sat.act<span class="op">$</span>SATV)</code></pre>
<pre><code>## [1] 112.9026</code></pre>
<p>Note that <code>NA</code> values can be removed from the vector when using the <code>sd()</code> function by setting the <code>na.rm</code> argument to <code>TRUE</code>. For instance, when we try to take the standard deviation of the quantitative SAT scores without removing <code>NA</code> values, we get <code>NA</code> as the output:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(sat.act<span class="op">$</span>SATQ)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>But by setting <code>na.rm=TRUE</code>, we get a sensible answer:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(sat.act<span class="op">$</span>SATQ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 115.6393</code></pre>
<p>The <code>NA</code> values cannot be removed this easily when calculating the standard deviation entirely by hand (that is, without using the <code>var()</code> function) because while the <code>sum()</code> function will take the <code>na.rm</code> argument, the <code>length()</code> function will not. Thus, if you plan to ask students to calculate the standard deviation by hand in R, be sure to choose a method of removing NA values manually. You can either remove the values yourself beforehand, give the students code to do it, or teach them to look out for and handle <code>NA</code> values themselves.</p>
</div>
<div id="standard-error-of-the-mean" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Standard Error of the Mean</h3>
<p>To calculate the standard error of the mean, simply extend the previous commands for calculating the standard deviation one step further by dividing the previous result by the number of observations minus one:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the squared deviations</span>
SATV_sq_diff &lt;-<span class="st"> </span>(sat.act<span class="op">$</span>SATV<span class="op">-</span><span class="kw">mean</span>(sat.act<span class="op">$</span>SATV))<span class="op">^</span><span class="dv">2</span>

<span class="co"># Sum squared deviations and divide by n-1</span>
SATV_var &lt;-<span class="st"> </span><span class="kw">sum</span>(SATV_sq_diff)<span class="op">/</span>(<span class="kw">length</span>(SATV_sq_diff)<span class="op">-</span><span class="dv">1</span>)

<span class="co"># Take the square root</span>
SATV_sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(SATV_var)

<span class="co"># Divide by n-1</span>
SATV_sd<span class="op">/</span>(<span class="kw">length</span>(SATV_sq_diff)<span class="op">-</span><span class="dv">1</span>)</code></pre>
<pre><code>## [1] 0.1615201</code></pre>
<p>More simply, students could take divide the output of <code>sd()</code> by the number of observations minus one:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(sat.act<span class="op">$</span>SATV)<span class="op">/</span>(<span class="kw">length</span>(sat.act<span class="op">$</span>SATV)<span class="op">-</span><span class="dv">1</span>)</code></pre>
<pre><code>## [1] 0.1615201</code></pre>
<p>In either case, because <code>length()</code> is used in the final step, the <code>NA</code> values cannot be easily removed when calculating the standard error of the mean by hand. You should therefore be sure to choose a method of removing NA values manually. You can either remove the values yourself beforehand, give the students code to do it, or teach them to look out for and handle <code>NA</code> values themselves.</p>
<p>Because there are different methods for calculating the standard error depending on the nature of the sample statistic, there is no central function for calculating the standard error in R. The <code>std.error()</code> function is available in the package <code>plotrix</code> and handily includes the <code>na.rm</code> argument. However, if <code>NA</code> values aren’t an issue, you may find that calculating the standard error is a simple enough extension of the standard deviation to have students do it by hand.</p>
</div>
<div id="correlation-proportion-of-variance-explained" class="section level3">
<h3><span class="header-section-number">3.3.6</span> Correlation &amp; Proportion of Variance Explained</h3>
<p>We do not recommend having students calculate Pearson’s <span class="math inline">\(r\)</span> by hand. Instead, the correlation coefficient can be found using the <code>cor()</code> function.</p>
<p>To demonstrate, imagine that we are curious as to whether there is a linear relationship between respondents’ verbal and quantitative SAT scores:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>We immediately note that the output is <code>NA</code> because there are missing values in the quantitative SAT scores. To remedy this, set the <code>use</code> argument to <code>complete.obs</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ, <span class="dt">use=</span><span class="st">&#39;complete.obs&#39;</span>)</code></pre>
<pre><code>## [1] 0.6442999</code></pre>
<p>With this method, <code>cor()</code> will remove any pairs containing at least one missing value before calculating the correlation coefficient.</p>
<p>To calculate the proportion of variance explained, <span class="math inline">\(R^2\)</span>, simply square the correlation coefficient:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ, <span class="dt">use=</span><span class="st">&#39;complete.obs&#39;</span>)<span class="op">^</span><span class="dv">2</span></code></pre>
<pre><code>## [1] 0.4151224</code></pre>
<p>This is a handy way of demonstrating that <span class="math inline">\(R^2\)</span> is very simply <span class="math inline">\(r\)</span>, squared.</p>
</div>
<div id="summary-functions" class="section level3">
<h3><span class="header-section-number">3.3.7</span> Summary Functions</h3>
<p>The standard method for summarizing data with multiple descriptive statistics at once is to use the <code>summary()</code> function. This function can be used to simultaneously summarize each variable in a data set, such as those in the <code>iris</code> data frame:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(iris)</code></pre>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>Numeric variables are summarized with the minimum and maximum values, the .25, .5, and .75 quantile cutoff values, and the mean value. Factors are summarized with a table of counts for each factor level. Character strings are summarized in terms of their total length.</p>
<p>A related function that is sometimes helpful is the <code>str()</code> function, which summarizes an object in terms of its class and the class of each of its elements:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(iris)</code></pre>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>While it can be inferred from the output of <code>summary()</code> that <code>Species</code> is a factor and the remaining variables are numeric, <code>str()</code> makes this explicit.</p>
<p>Note that additional techniques exist for summarizing data with multiple descriptive statistics. The <code>describe()</code> function in the <code>psych</code> package provides a range of useful statistics for numeric variables. Tools provided in the <code>dplyr</code> package, particularly the combination of <code>group_by()</code> and <code>summarize()</code>, allow the user to specify their own descriptive statistics.</p>
</div>
</div>
<div id="plotting" class="section level2">
<h2><span class="header-section-number">3.4</span> Plotting</h2>
<p>One of the most compelling reason to learn and use R is because it includes highly flexible and powerful tools for visualizing many kinds of data. After all, if a single tool can perform your analyses and create your figures, why not use the “one ring to rule them all”?</p>
<p>Many visualizations can be created using the <code>plot()</code> function, so we’ll begin our introduction using that function. As you’ll soon see, the <code>plot()</code> function accepts many arguments, as there are many ways to customize a plot. Many of the other visualization tools in R accept similar arguments. So, if <code>plot()</code> accepts an argument, there is a fair chance another function will accept it as well.</p>
<div id="scatter-line-plots" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Scatter &amp; Line Plots</h3>
<p>If you have two vectors representing pairs of observations, you can plot them against one another in a scatter plot using the <code>plot()</code> function. Let’s demonstrate this by plotting the SAT Verbal and SAT Quantitative scores from the <code>sat.act</code> dataset against one another.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ) <span class="co"># Access the columns as vectors using $ syntax</span></code></pre>
<p><img src="statistics_files/figure-html/basicplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The points in the plot above represent pairs SAT Verbal and SAT Quantitative scores. The scores in each vector are paired up by position within each vector - the first value in <code>SATV</code> is paired with the first value in <code>SATQ</code>, the second value in <code>SATV</code> is paired with the second value in <code>SATQ</code>, etc. The vector given as the first argument determines the X axis position, and the vector given as the second argument determines the Y axis position.</p>
<p>The axis titles are determined by the variable names of the vectors supplied to the <code>plot</code> function. However, variable names aren’t always the most informative names for other humans to read. We can customize the axes and plot with informative titles using the <code>xlab</code>, <code>ylab</code> and <code>main</code> arguments for the <code>plot</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>)</code></pre>
<p><img src="statistics_files/figure-html/axeslabels-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="linetypes-symbols-and-colors" class="section level4">
<h4><span class="header-section-number">3.4.1.1</span> Linetypes, Symbols, and Colors</h4>
<p>You can customize the scatterplot to draw lines between the points, or just draw lines without the point symbols with the <code>type</code> argument. <strong>This is not a sensible thing to do for these data</strong>, but we demonstrate it anyway for completeness.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Lines and points</span>
<span class="kw">plot</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>,
     <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:lines1"></span>
<img src="statistics_files/figure-html/lines-1.png" alt="Points and lines with type='o'" width="672" />
<p class="caption">
Figure 3.1: Points and lines with type=‘o’
</p>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Just lines</span>
<span class="kw">plot</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>,
     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:lines2"></span>
<img src="statistics_files/figure-html/lines-2.png" alt="Just using lines with type='l'" width="672" />
<p class="caption">
Figure 3.2: Just using lines with type=‘l’
</p>
</div>
<p>You can also customize the types of symbols that are used for each point using the <code>pch</code>, the style of lines connecting these points using the <code>lty</code> argument, and the <code>col</code> argument to adjust the color of lines and symbol borders</p>
<p>With the <code>pch</code> argument, you specify the symbol used for each point using a numeric code. For example, the value <code>0</code> is the code for an unfilled square, while the value <code>15</code> is the value for a filled square with no border. Unfortunately, it has been scientifically proven that remembering the code for all the possible symbols is impossible. Luckily, a helpful mnemonic device called a “chart” has been invented to help R programmers customize their plots. This chart is shown below:</p>
<p><img src="images/pch.png" /></p>
<p>Note that if you supply a character instead of a numeric values between 0 and 25, R will use that character as the plotting symbol. So, you could make a plot full of pound signs if you are so inclined!</p>
<p>The <code>lty</code> argument has a bit more flexibility. Line types can either be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash) or as one of the character strings “blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, or “twodash”.</p>
<p>The <code>col</code> argument accepts character strings describing either a “built in” color name (see <code>?colors</code> for a list) or an RGB triplet encoded in hexadecimal notation. Unless you are intimately familiar with RGB color space, it’s a good idea to use a tool like the <a href="https://www.w3schools.com/colors/colors_picker.asp">W3 Organizations Online Color Picker</a> to help you figure out the RGB hex code for the color you want.</p>
<p>To demonstrate, lets take our original plot (with no lines) and customize it to use unfilled, magenta triangles:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Lines and points</span>
<span class="kw">plot</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>,
     <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>, <span class="dt">pch=</span><span class="dv">2</span>)</code></pre>
<p><img src="statistics_files/figure-html/pch_and_col-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="axis-limits" class="section level4">
<h4><span class="header-section-number">3.4.1.2</span> Axis limits</h4>
<p>R usually does a good job of determining good values for the range of each axis, but if you wish to override the defaults, you can do do using the <code>xlim</code> and <code>ylim</code> arguments. These arguments accepts 2-element numeric vectors specifying the minimum and maximum values along each axis (in that order). For example, if we wanted to include 0 in the range of SAT scores shown on the plot, we could use <code>c(0, 800)</code> for both our axis limits:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Lines and points</span>
<span class="kw">plot</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>,
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">800</span>),
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">800</span>))</code></pre>
<p><img src="statistics_files/figure-html/limits-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This isn’t particularly sensible, because 0 is not a possible score on the SAT, so consider this just a demonstration of R’s capabilities.</p>
</div>
<div id="adding-to-an-existing-plot" class="section level4">
<h4><span class="header-section-number">3.4.1.3</span> Adding to an existing plot</h4>
<p>In many cases, it is useful to have <em>different</em> symbols, colors, and linetypes on the same plot - for example, to denote observations from different groups. There is more than one way to achieve this effect, but when you want different symbols, colors, and linetypes on the same plot, often the easiest way to do it is plot each group one at a time.</p>
<p>To do this, you begin with the familiar plot command, but use it to plot only a subset of the data. Then, you can use the <code>points</code> or <code>lines</code> function to add additional points (or lines) to the plot. We’ll demonstrate how you can plot the SAT scores for males and females in different colors by subsetting the dataset, and then using the <code>plot</code> and <code>points</code> functions:</p>
<pre class="sourceCode r"><code class="sourceCode r">males &lt;-<span class="st"> </span>sat.act[sat.act<span class="op">$</span>gender <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]
females &lt;-<span class="st"> </span>sat.act[sat.act<span class="op">$</span>gender <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]
<span class="kw">plot</span>(males<span class="op">$</span>SATV, males<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>,
     <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">points</span>(females<span class="op">$</span>SATV, females<span class="op">$</span>SATQ, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</code></pre>
<p><img src="statistics_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-a-legend" class="section level4">
<h4><span class="header-section-number">3.4.1.4</span> Adding a legend</h4>
<p>If you use multiple symbols, colors, and linetypes on the same plot, you’ll also need a legend telling the viewer how to interpret the different symbols, colors, and linetypes. You can add legends to an existing plot using the <code>legend</code> function. Unfortunately, the <code>legend</code> function doesn’t know what symbols, colors, and linetypes you’ve used, or what the different groups in your data are. So, you’ll have to re-capitulate this information to the legend function. Make <em>absolutely</em> sure that you specify the labels, colors, symbol codes, and linetypes in the exact same order you added them to the plot! You also must specify a <code>pch</code> or <code>linetype</code> value, even if you used the default value in your plot!</p>
<p>Perhaps the trickiest part about using the legend function is figuring out where to place the legend. The location may also be specified by setting the first argument to the legend function to a single keyword from the set “bottomright”, “bottom”, “bottomleft”, “left”, “topleft”, “top”, “topright”, “right” or “center”. Alternatively, you can get fine-grained control over the placement by providing two values that represent an x,y coordinate for the top-right corner of the legend:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(males<span class="op">$</span>SATV, males<span class="op">$</span>SATQ,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>,
     <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">points</span>(females<span class="op">$</span>SATV, females<span class="op">$</span>SATQ, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">200</span>, <span class="dt">y=</span><span class="dv">800</span>,
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Males&quot;</span>, <span class="st">&quot;Females&quot;</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),
       <span class="dt">pch=</span><span class="dv">1</span>)</code></pre>
<p><img src="statistics_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-a-regression-line" class="section level4">
<h4><span class="header-section-number">3.4.1.5</span> Adding a regression line</h4>
<p>It is often useful to summarize the linear relationship between variables shown in a scatterplot. It is easy to add the “line of best fit” from a linear regression to your scatter plot using the <code>lm</code> function (short for "linear model) and the <code>abline</code> function (used for drawing straight lines).</p>
<p>The <code>lm</code> function performs regression analysis based on the <a href="statistics.html#formula-objects">formula</a> you specify. If you intend on adding the regression line to your scatterplot, we recommend you use the formula interface to the <code>plot()</code> function. Instead of using an <code>x</code> vector and a <code>y</code> vector, you can provide a formula of the form <code>y ~ x</code>, and the name of the data frame containing your vaiable, just like when using the <code>lm</code> function.
In this case, you would use the same formula to specify your plot that you use to specify your regression model. Remember of course, that the response variable (i.e., the y variable) goes first in the formula, not second as it would if you were providing two separate vectors.</p>
<p>To summarise, the basic steps are:</p>
<ol style="list-style-type: decimal">
<li>Perform your linear regression with <code>lm</code>, and save the output to a variable</li>
<li>Create your scatterplot using the same formula specification as in your linear model from Step 1.</li>
<li>Provide the <code>lm</code> object you saved in Step #1 to the <code>abline</code> function</li>
<li>Marvel at your wonderful new plot</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">regression_results &lt;-<span class="st"> </span><span class="kw">lm</span>(SATQ <span class="op">~</span><span class="st"> </span>SATV, <span class="dt">data=</span>sat.act)
<span class="kw">plot</span>(SATQ <span class="op">~</span><span class="st"> </span>SATV, <span class="dt">data=</span>sat.act,
     <span class="dt">xlab =</span> <span class="st">&quot;SAT Verbal&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;SAT Quantitative&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;Relationship between SAT Scores&quot;</span>)
<span class="kw">abline</span>(regression_results, <span class="dt">lwd=</span><span class="dv">2</span>) <span class="co"># lwd = &quot;line width&quot;,</span></code></pre>
<p><img src="statistics_files/figure-html/abline%20plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In the call to <code>abline</code> above, we have specified the <code>lwd</code> argument, short for “line width”, a.k.a. thickness. The default value is 1, and we have double the thickness here so the regression line stands out from the points more.</p>
</div>
</div>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Histograms</h3>
<p>You can create a histogram showing the counts or proportion of values from a single variable using the <code>hist</code> function.</p>
<p>The <code>hist</code> function works with a vector of numeric values, and breaks this vector up into a number of discrete bins. By default, the <code>hist</code> function decides what the boundary values of the bins should be, and how many bins should be used, by applying the <a href="https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/nclass.html">Sturges algorithm</a>. However, you can manually control where the boundaries are placed by providing a vector of boundary values, or by providing a single value specifying the number of bins that should be used. We demonstrate both techniques below in plotting a histogram of ACT scores:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> <span class="dv">30</span>)</code></pre>
<p><img src="statistics_files/figure-html/hist-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r">bin_boundaries &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">max</span>(sat.act<span class="op">$</span>ACT), <span class="dt">by=</span><span class="dv">2</span>) <span class="co"># from 0 to 36 by 2&#39;s</span>
<span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> bin_boundaries)</code></pre>
<p><img src="statistics_files/figure-html/hist-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you want proportions instead of counts, set the <code>freq</code> argument to false. You can also use the same <code>xlab</code>, <code>ylab</code>, and <code>main</code> arguments we used with <code>plot</code> to get more informative titles/</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>,
     <span class="dt">main =</span> <span class="st">&quot;Distribution of ACT Scores&quot;</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;ACT Score&quot;</span>)</code></pre>
<p><img src="statistics_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="boxplots" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Boxplots</h3>
<p>Box plots are a good way to present the shape of distribution of samples from several groups, along with some summary statistics of each group. We can create these plots in R using the <code>boxplot</code> function.</p>
<p>If your to-be-plotted data is in a data frame, the best way to instruct the <code>boxplot</code> function what variables should be plotted is using a <a href="statistics.html#formula-objects">formula</a>. If they are not in a data frame, you can provide each to-be-plotted variable as a separate vector. Here, we’ll demonstrate the formula interface by plotting the SAT Verbal scores for respondents with education levels. Remember, when using the formula interface, you also have to tell the <code>boxplot</code> function what data frame to look for the variables in!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(SATV <span class="op">~</span><span class="st"> </span>education, <span class="dt">data=</span>sat.act,
        <span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;&lt; High School&quot;</span>, <span class="st">&quot;High School&quot;</span>, <span class="st">&quot;Some College&quot;</span>,
                <span class="st">&quot;2 Yr. College&quot;</span>, <span class="st">&quot;4 Yr. College&quot;</span>, <span class="st">&quot;Grad. Work&quot;</span>),
        <span class="dt">ylab=</span><span class="st">&quot;SAT Verbal Score&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Education&quot;</span>)</code></pre>
<p><img src="statistics_files/figure-html/boxplot-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Note the use of the <code>names</code> argument to override the labels on each X axis point. Depending on how long the names of each variable are, some variable names might be ommitted from the axis labels, in order to prevent having overlapping characters obscuring the names. This can usually be be remedied by re-sizing the plot window to be larger, so that all the names can fit in.</p>
</div>
<div id="bar-plots" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Bar plots</h3>
<p>Bar plots are used to visualize single summary statistics, like the mean or median across groups. We can create a bar plot in R using the <code>barplot</code> function. We’ll demonstrate this by plotting the mean SAT Verbal score for males and females. The to-be-plotted value should be specified in a vector or matrix, with one element for each bar you want plotted</p>
<pre class="sourceCode r"><code class="sourceCode r">SATV_means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(sat.act<span class="op">$</span>SATV[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">1</span>]),
                <span class="kw">mean</span>(sat.act<span class="op">$</span>SATV[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">2</span>])
                )
<span class="kw">names</span>(SATV_means) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Males&quot;</span>,<span class="st">&quot;Females&quot;</span>)
<span class="kw">barplot</span>(SATV_means,
        <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">800</span>), <span class="dt">ylab=</span><span class="st">&quot;Average SAT Verbal Score&quot;</span>,
        <span class="dt">main=</span><span class="st">&quot;SAT Verbal Scores for Males &amp; Females&quot;</span>
        )</code></pre>
<p><img src="statistics_files/figure-html/barplot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-plots-in-single-figure" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Multiple plots in single figure</h3>
<p>In many situations, it is useful to have several different plots in a single figure to facilitate comparison. But in the examples we have encountered so far, each time we create a new plot, it has removed the existing one from out figure window. We can change this behavior to allow multiple figures within the same window by using the <code>par</code> function, which changes R’s global graphics parameters.</p>
<p>We can set the number of plots that go into a figure window much in the same way we set the dimensions of a matrix - by specifying how many rows of plots there can be, and how many columns of plots there can be. The product of these two values determines the number of plots that are put on a single figure window.</p>
<p>There are two global graphics parameters that allow us to set these dimensions - the <code>mfrow</code> parameter, and the <code>mfcol</code> parameter. The <code>mf</code> stands for “multiple figures”, and the <code>row</code> or <code>col</code> part means the figures are filled in by rows, or by columns. Here, we demonstrate how to use the <code>mfrow</code> option to create a 2 by 2 grid of plots, which will allow us to compare the distribution of ACT scores in histograms with different numbers of breaks:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> <span class="dv">10</span>, <span class="dt">main =</span> <span class="st">&quot;10 breaks&quot;</span>)
<span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">main =</span> <span class="st">&quot;30 breaks&quot;</span>)
<span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">main =</span> <span class="st">&quot;50 breaks&quot;</span>)
<span class="kw">hist</span>(sat.act<span class="op">$</span>ACT, <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">main =</span> <span class="st">&quot;100 breaks&quot;</span>)</code></pre>
<p><img src="statistics_files/figure-html/par_mfrow-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Reset back to default</span></code></pre>
<p>Always make sure to set your <code>mfrow</code> or <code>mfcol</code> values back to <code>c(1,1)</code> afterwards, or <em>all</em> subsequent plots will use the same layout!</p>
</div>
<div id="saving-plots" class="section level3">
<h3><span class="header-section-number">3.4.6</span> Saving Plots</h3>
<p>Usually the purpose of creating a visualization in R is to include it in some kind of homework, report, or paper. It is easy to save a plot made in R to an image file on your hard drive using the “Export” option in the R Studio plot pane. Simply click the “Export” drop down menu, and select either the “Save to Image”, “Save to PDF” or “Copy to Clipboard” options.</p>
<p><img src="images/export_plot.png" /></p>
<p>If you choose the “Save as Image” option, you’ll get to choose which image format you want to save it as, and what the width and height (in pixels) the image should be saved as.</p>
</div>
<div id="what-about-ggplot" class="section level3">
<h3><span class="header-section-number">3.4.7</span> What about ggplot?</h3>
<p>The <a href="https://www.rdocumentation.org/packages/ggplot2/versions/3.1.1">ggplot2 package</a> is an extremely popular visualization tool, which provides an alternative to the so-called “base graphics” functions described here. The popularity ggplot has achieved is well deserved - its visualizations are attractive, and its data-driven, modular coding style is very powerful. The programming style of ggplot is <em>very</em> different from the base graphics style. Perhaps the best way to summarize the ggplot approach is that it is builds on top of the organization of the observations inside a data frame and allows you to “map” the variables in your data frame to the “aesthetics” in a plot (shape, position, color, size, etc.).</p>
<p>We will not cover ggplot here, because it is not a necessity for 240 and 241 (though, in our opinion, a proficient R programmer should know how both ggplot <em>and</em> base graphics). However, we will re-iterate the advice the ggplot package authors give for those wishing to learn how to use ggplot:</p>
<blockquote>
<p>If you are new to ggplot2 you are better off starting with a systematic introduction, rather than trying to learn from reading individual documentation pages. Currently, there are three good places to start:</p>
<ol style="list-style-type: decimal">
<li><p>The <a href="http://r4ds.had.co.nz/data-visualisation.html">data visualisation</a> and <a href="http://r4ds.had.co.nz/graphics-for-communication.html">graphics for communication</a> chapters in <a href="http://r4ds.had.co.nz/">R for data science</a>.</p></li>
<li><p>If you’d like to take an interactive online course, try <a href="https://www.datacamp.com/courses/data-visualization-with-ggplot2-1">Data visualisation with ggplot2</a> by Rick Scavetta on DataCamp.</p></li>
<li><p>If you want to dive into making common graphics as quickly as possible, I recommend <a href="http://amzn.to/2dVfMfn">The R Graphics Cookbook</a> by Winston Chang.</p></li>
</ol>
</blockquote>
</div>
</div>
<div id="inferential-statistics" class="section level2">
<h2><span class="header-section-number">3.5</span> Inferential Statistics</h2>
<div id="distribution-functions" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Distribution Functions</h3>
<p>The sections below introduce functions for executing common statistical tests. However, R’s family of distribution functions also make it possible to explore the underlying probability distributions for each test, and to carry out each test by hand. We therefore begin our demonstration of inferential statistics by giving an overview of these powerful instructional tools.</p>
<p>The full list of available distributions can be found <a href="https://en.wikibooks.org/wiki/R_Programming/Probability_Distributions">here</a>. The following table provides an overview the distributions that are likely to be relevant to you as an instructor, including the suffix that each distribution is identified by in the functions below:</p>
<table>
<thead>
<tr class="header">
<th align="left">Distribution</th>
<th align="left">Suffix</th>
<th align="left">Parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left"><code>norm</code></td>
<td align="left">mean, SD</td>
</tr>
<tr class="even">
<td align="left">Student’s T</td>
<td align="left"><code>t</code></td>
<td align="left">df, non-centrality</td>
</tr>
<tr class="odd">
<td align="left">Chi-Square</td>
<td align="left"><code>chisq</code></td>
<td align="left">df, non-centrality (non-negative)</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left"><code>f</code></td>
<td align="left">df<sub>1</sub>, df<sub>2</sub>, non-centrality</td>
</tr>
<tr class="odd">
<td align="left">Binomial</td>
<td align="left"><code>binom</code></td>
<td align="left">size (number of observations), probability</td>
</tr>
<tr class="even">
<td align="left">Uniform</td>
<td align="left"><code>unif</code></td>
<td align="left">minimum, maximum</td>
</tr>
</tbody>
</table>
<p>View the help documentation for default parameter values and additional details.</p>
<p>Each distribution can be accessed by a set of four functions, each labelled with the distribution’s suffix and a task-specific prefix:</p>
<table style="width:100%;">
<colgroup>
<col width="11%" />
<col width="77%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Prefix</th>
<th align="left">Task</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">d</td>
<td align="left">Get the probability density associated with a point on the x-axis.</td>
<td align="left"><code>dnorm()</code></td>
</tr>
<tr class="even">
<td align="left">p</td>
<td align="left">Get the probability of a value above or below a point on the x-axis.</td>
<td align="left"><code>pnorm()</code></td>
</tr>
<tr class="odd">
<td align="left">q</td>
<td align="left">Get the x-axis value marking a cumulative probability.</td>
<td align="left"><code>qnorm()</code></td>
</tr>
<tr class="even">
<td align="left">r</td>
<td align="left">Get a random sample from the distribution.</td>
<td align="left"><code>rnorm()</code></td>
</tr>
</tbody>
</table>
<p>These functions are each demonstrated in the following sub-sections using the normal distribution. In these examples, consider that IQ scores are meant to be normally distributed with a mean of 100 and a standard deviation of 15:</p>
<p><img src="statistics_files/figure-html/IQ%20histogram%20with%20curve-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="getting-densities" class="section level4">
<h4><span class="header-section-number">3.5.1.1</span> Getting Densities</h4>
<p>The functions for getting the probability density associated with a point on the x-axis, such as <code>dnorm()</code> in the case of the normal distribution, are unlikely to come up in class. However, they may be useful for generating figures such as the one above, which was created with the following code:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(<span class="kw">rnorm</span>(<span class="dv">10000</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>), <span class="dt">freq=</span><span class="ot">FALSE</span>,
     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.03</span>), <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>, <span class="dt">main=</span><span class="st">&#39;IQ Scores&#39;</span>)
<span class="kw">points</span>(<span class="dt">x=</span><span class="kw">seq</span>(<span class="dv">40</span>, <span class="dv">160</span>, <span class="fl">.001</span>),
       <span class="dt">y=</span><span class="kw">dnorm</span>(<span class="kw">seq</span>(<span class="dv">40</span>, <span class="dv">160</span>, <span class="fl">.001</span>), <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>),
       <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</code></pre>
<p>Note that the input to <code>dnorm()</code> was a sequence of values from 40 to 160, by steps of .001. The output was the probability density for each value in the sequence. These values were then used to create a continuous curve that was added to the histogram of the data, in which the argument <code>freq=FALSE</code> ensured that the y-axis denoted probability densities instead of counts. A more detailed tutorial is provided <a href="https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/histdens.html">here</a>.</p>
</div>
<div id="getting-probabilities" class="section level4">
<h4><span class="header-section-number">3.5.1.2</span> Getting Probabilities</h4>
<p>You can use <code>pnorm()</code> to demonstrate that there is a 9.12% chance of getting an IQ score that is less than or equal to 80:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dv">80</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>)</code></pre>
<pre><code>## [1] 0.09121122</code></pre>
<p>To find the probability of getting a value <em>greater than</em> or equal to a cutoff, such as 80, you can either add the argument <code>lower.tail=FALSE</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="dv">80</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</code></pre>
<pre><code>## [1] 0.9087888</code></pre>
<p>…or, since the area under the curve sums to 1, you can subtract the output of the previous command from 1:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">80</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>)</code></pre>
<pre><code>## [1] 0.9087888</code></pre>
<p>The latter method may be better for instructional purposes.</p>
</div>
<div id="getting-quantiles" class="section level4">
<h4><span class="header-section-number">3.5.1.3</span> Getting Quantiles</h4>
<p>You can use <code>qnorm()</code> to demonstrate that an IQ score of 124.67 marks the 95<sup>th</sup> percentile of scores:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(.<span class="dv">95</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>)</code></pre>
<pre><code>## [1] 124.6728</code></pre>
<p>Similarly, you can add the argument <code>lower.tail=FALSE</code> to see the point on the x-axis that marks the <em>top</em> 95% of scores:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(.<span class="dv">95</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</code></pre>
<pre><code>## [1] 75.3272</code></pre>
<p>Note that subtracting from 1 does not work here as it did with <code>pnorm()</code> because the output of <code>qnorm()</code> is a quantile, which does not need to sum to 1 as probabilities do.</p>
</div>
<div id="getting-random-samples" class="section level4">
<h4><span class="header-section-number">3.5.1.4</span> Getting Random Samples</h4>
<p>You can use <code>rnorm()</code> to randomly sample a class of 50 students from the population of IQ scores:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>)</code></pre>
<pre><code>##  [1] 105.59088 141.41325 109.27092 103.21301 103.10922  96.01118  88.91119
##  [8]  98.45228 107.77575  93.82389 119.18946 107.13198 112.19677  99.77637
## [15] 108.43054  63.32241  79.33576  95.36238 131.72355  98.33870  94.47536
## [22]  85.05919 145.16068 101.86471  94.94045  97.74303 101.84727  94.22807
## [29]  77.34755 106.86618 114.12983 123.59548  88.63259  73.09013  97.15892
## [36] 122.27776  78.12674 104.86592  98.67181 105.07155 120.25942 102.03413
## [43] 106.62404  71.02081  83.35175  84.19040 114.33629  92.20393  94.88957
## [50]  98.98736</code></pre>
</div>
<div id="running-statistical-tests-by-hand" class="section level4">
<h4><span class="header-section-number">3.5.1.5</span> Running Statistical Tests by Hand</h4>
<p>These functions can be used to conduct statistical analyses by hand. Consider a demonstration of a z-test using the functions for the normal distribution. To test whether an IQ score of 135 is significantly different from the mean IQ score, first find the z-score:</p>
<pre class="sourceCode r"><code class="sourceCode r">IQ135_z &lt;-<span class="st"> </span>(<span class="dv">135-100</span>)<span class="op">/</span><span class="dv">15</span>
IQ135_z</code></pre>
<pre><code>## [1] 2.333333</code></pre>
<p>You could then compare that z-score to the critical z-scores associated with an alpha of .05, here assuming a two-tailed hypothesis:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(.<span class="dv">025</span>)</code></pre>
<pre><code>## [1] -1.959964</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qnorm</span>(.<span class="dv">975</span>)</code></pre>
<pre><code>## [1] 1.959964</code></pre>
<p>The z-score of an IQ of 135 is greater than the critical z-score for the upper tail, so we can reject the null hypothesis. Note that for a one-tailed hypothesis, simply use one call to <code>qnorm()</code> with .05 or .95 for the lower or upper tail, respectively.</p>
<p>Alternatively, you could find the probability of getting a z-score that is equal to the test score or more extreme (in this case, more positive), and compare that to the alpha value instead of the critical z-score:</p>
<pre class="sourceCode r"><code class="sourceCode r">IQ135_z_prob &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(IQ135_z)</code></pre>
<p>The probability of getting an IQ of 135 is less than alpha (either .025 for a two-tailed hypothesis or .05 for a one-tailed hypothesis), so we reject the null hypothesis.</p>
<p>Note that you could also apply this method by finding the probability of an IQ of 135 given a mean of 100 and standard deviation of 15, and compare that to the alpha value instead:</p>
<pre class="sourceCode r"><code class="sourceCode r">IQ135_prob &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">135</span>, <span class="dt">mean=</span><span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">15</span>)</code></pre>
<p>This provides the same probability as for the z-score, so we make the same conclusion. However, though it uses one line of code instead of two, you may find that this method is more confusing for some students, particularly if they are used to seeing distributions centered on 0 elsewhere in the course.</p>
<p>This same process can be extended to a range of statistical tests, including t tests, F tests, Chi-Square tests, and binomial tests.</p>
</div>
</div>
<div id="confidence-intervals" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Confidence Intervals</h3>
<p>Confidence intervals can be calculated by hand in R using the distribution functions. Recall that the formula for a confidence interval is:</p>
<p><span class="math display">\[CI=\bar{x} \pm (critical \: statistic) \frac{s}{\sqrt{n}}\]</span></p>
<p>The following demonstration will be conducted using the normal distribution, but the same process can be generalized to other statistics. We will continue with the theoretical distribution of IQ scores used above in which the mean is 100 and the standard deviation is 15.</p>
<p>Imagine that we tested the IQ of 100 students, simulated here with a call to <code>rnorm()</code>:</p>
<p>We know that the sample size, n, is 100. To find the 95% confidence interval, we would need to also find the sample mean, the sample standard deviation, and the critical z score that marks the .975 percentile:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the mean</span>
mean_IQ &lt;-<span class="st"> </span><span class="kw">mean</span>(sample_IQ)

<span class="co"># Find the standard deviation</span>
sd_IQ &lt;-<span class="st"> </span><span class="kw">sd</span>(sample_IQ)

<span class="co"># Find the critical z-score (upper tail)</span>
z_crit &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>)</code></pre>
<p>Note that we only need to find the z-score that marks the .975 percentile because the normal distribution is symmetric, so the critical z-score for the .025 percentile is simply the negative of this value. You can, however, choose to ask your students to find both separately if you think it would help from an instructional standpoint.</p>
<p>Then, we combine all of these ingredients to find the upper and lower limits of the confidence interval:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the lower limit</span>
CI_lower &lt;-<span class="st"> </span>mean_IQ <span class="op">-</span><span class="st"> </span>z_crit<span class="op">*</span>(sd_IQ<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">100</span>))
CI_lower</code></pre>
<pre><code>## [1] 95.07892</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the upper limit</span>
CI_upper &lt;-<span class="st"> </span>mean_IQ <span class="op">+</span><span class="st"> </span>z_crit<span class="op">*</span>(sd_IQ<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">100</span>))
CI_upper</code></pre>
<pre><code>## [1] 101.0841</code></pre>
<p>The confidence interval ranges from 98.41 to 104.88, suggesting that if this experiment had been repeated over and over an infinite number of times, the true population mean would be within that range 95% of the time.</p>
<p>Note that while calculating confidence intervals by hand is a useful instructional tool, some functions for statistical tests do give the confidence interval “for free”, such as <code>t.test()</code> and <code>binom.test()</code>. Make sure to be clear with students when it is acceptable to get confidence intervals from these functions to complete assignments.</p>
</div>
<div id="t.test" class="section level3">
<h3><span class="header-section-number">3.5.3</span> <code>t.test()</code></h3>
<p>The <code>t.test()</code> function can be used to execute one-sample, paired, or two-sample t-tests. Each case is demonstrated below, but first note three general arguments that can be used to augment the test:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>alternative</code></td>
<td align="left">Set to <code>two.sided</code> for a two-sided test, <code>less</code> for the lower tail, and <code>greater</code> for the upper tail; the default is <code>two.sided</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>var.equal</code></td>
<td align="left">Set to <code>TRUE</code> to assume equal variance and <code>FALSE</code> otherwise; the default is <code>FALSE</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>conf.level</code></td>
<td align="left">Provide a number between 0 and 1 to specify the range for the confidence interval; the default is .95.</td>
</tr>
</tbody>
</table>
<div id="one-sample-t-tests" class="section level4">
<h4><span class="header-section-number">3.5.3.1</span> One-sample t-tests</h4>
<p>To demonstrate a one-sample t-test, imagine that we are curious whether the average verbal SAT score in the <code>sat.act</code> data set is different from 0. We could test that question with the following call:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(sat.act<span class="op">$</span>SATV)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  sat.act$SATV
## t = 143.47, df = 699, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  603.8560 620.6126
## sample estimates:
## mean of x 
##  612.2343</code></pre>
<p>The output of <code>t.test()</code> gives us a nice summary of the results, including the t-statistic, degrees of freedom, p-value, and 95% confidence interval. The p-value is essentially 0, so we can reject the null hypothesis that the average verbal SAT score is 0.</p>
<p>If we wanted to instead see if the average verbal SAT score was different from 650, we could change the null comparison value by setting the <code>mu</code> parameter:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(sat.act<span class="op">$</span>SATV, <span class="dt">mu=</span><span class="dv">600</span>)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  sat.act$SATV
## t = 2.867, df = 699, p-value = 0.004269
## alternative hypothesis: true mean is not equal to 600
## 95 percent confidence interval:
##  603.8560 620.6126
## sample estimates:
## mean of x 
##  612.2343</code></pre>
<p>The p-value is 0.004, so we can reject the null hypothesis that the average verbal SAT score is 600. Instead, it appears to be higher.</p>
</div>
<div id="paired-t-tests" class="section level4">
<h4><span class="header-section-number">3.5.3.2</span> Paired t-tests</h4>
<p>To demonstrate a paired t-test, imagine that we are curious as to whether verbal SAT scores are different from quantitative SAT scores. We can conduct this in one of two ways.</p>
<p>First, we could calculate the difference score for each pair, then run a one-sample t-test comparing the average difference score to 0:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate difference scores</span>
sat.act<span class="op">$</span>SAT_diff &lt;-<span class="st"> </span>sat.act<span class="op">$</span>SATV<span class="op">-</span>sat.act<span class="op">$</span>SATQ

<span class="co"># Run a one-sample t-test</span>
<span class="kw">t.test</span>(sat.act<span class="op">$</span>SAT_diff)</code></pre>
<pre><code>## 
##  One Sample t-test
## 
## data:  sat.act$SAT_diff
## t = 0.57483, df = 686, p-value = 0.5656
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -5.116109  9.351917
## sample estimates:
## mean of x 
##  2.117904</code></pre>
<p>The p-value is .566, so we fail to reject the null hypothesis that the difference between verbal and quantitative SAT scores are approximately zero.</p>
<p>In the second method, we could have <code>t.test()</code> compute the difference scores for us by specifying both samples and setting the <code>paired</code> argument to <code>TRUE</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ, <span class="dt">paired=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## 
##  Paired t-test
## 
## data:  sat.act$SATV and sat.act$SATQ
## t = 0.57483, df = 686, p-value = 0.5656
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -5.116109  9.351917
## sample estimates:
## mean of the differences 
##                2.117904</code></pre>
<p>We get exactly the same result. However, note that though this method uses fewer lines of code it risks obscuring the role of difference scores for the student.</p>
</div>
<div id="two-sample-t-tests" class="section level4">
<h4><span class="header-section-number">3.5.3.3</span> Two-sample t-tests</h4>
<p>To demonstrate a two-sample t-test, imagine that we are curious as to whether male and female students reported different quantitative SAT scores.</p>
<p>The function call is very similar to the second method for conducting a paired t-test, but we set the <code>paired</code> argument to <code>FALSE</code> instead:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(sat.act<span class="op">$</span>SATQ[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">1</span>], sat.act<span class="op">$</span>SATQ[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">2</span>], <span class="dt">paired=</span><span class="ot">FALSE</span>)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  sat.act$SATQ[sat.act$gender == 1] and sat.act$SATQ[sat.act$gender == 2]
## t = 4.3544, df = 492.94, p-value = 1.624e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  21.88433 57.87165
## sample estimates:
## mean of x mean of y 
##  635.8735  595.9955</code></pre>
<p>The p-value is approximately .00002, so we can reject the null hypothesis that male and female students report essentially the same quantitative SAT scores. Instead, the mean score for males appears to be higher.</p>
<p>Note that the default value for the <code>paired</code> argument is <code>FALSE</code>, so running the above call with the <code>paired</code> argument omitted would produce the same result. However, you might want to encourage students to always specify the argument for a t-test with two samples so that they can be sure they are running the intended test.</p>
<p>Further, note that the above example indexes the male and female groups within the call to <code>t.test()</code>, but you could also ask students to do this separately beforehand:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Subset the groups</span>
male_SATQ &lt;-<span class="st"> </span>sat.act<span class="op">$</span>SATQ[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">1</span>]
female_SATQ &lt;-<span class="st"> </span>sat.act<span class="op">$</span>SATQ[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">2</span>]

<span class="co"># Run a two-sample t-test</span>
<span class="kw">t.test</span>(male_SATQ, female_SATQ, <span class="dt">paired=</span><span class="ot">FALSE</span>)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  male_SATQ and female_SATQ
## t = 4.3544, df = 492.94, p-value = 1.624e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  21.88433 57.87165
## sample estimates:
## mean of x mean of y 
##  635.8735  595.9955</code></pre>
</div>
</div>
<div id="aov" class="section level3">
<h3><span class="header-section-number">3.5.4</span> <code>aov()</code></h3>
<p>The <code>aov()</code> function can be used to execute an ANOVA. The basic call includes one argument, which is a formula object. Whether <code>aov()</code> is used to run a one-way, two-way, or multi-way ANOVA, with or without interaction terms, is based entirely on the formula.</p>
<div id="one-way-anova" class="section level4">
<h4><span class="header-section-number">3.5.4.1</span> One-way ANOVA</h4>
<p>To demonstrate a one-way ANOVA, imagine that we are curious as to whether verbal SAT scores vary across education level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aov</span>(sat.act<span class="op">$</span>SATV <span class="op">~</span><span class="st"> </span>sat.act<span class="op">$</span>education)</code></pre>
<pre><code>## Call:
##    aov(formula = sat.act$SATV ~ sat.act$education)
## 
## Terms:
##                 sat.act$education Residuals
## Sum of Squares              19247   8890899
## Deg. of Freedom                 1       698
## 
## Residual standard error: 112.8613
## Estimated effects may be unbalanced</code></pre>
<p>The standard output of aov does not contain readily interpretable results. To get the ANOVA table, it is better to save the output of <code>aov()</code>, then call <code>summary()</code> on that saved object:</p>
<pre class="sourceCode r"><code class="sourceCode r">educ_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(sat.act<span class="op">$</span>SATV <span class="op">~</span><span class="st"> </span>sat.act<span class="op">$</span>education)
<span class="kw">summary</span>(educ_aov)</code></pre>
<pre><code>##                    Df  Sum Sq Mean Sq F value Pr(&gt;F)
## sat.act$education   1   19247   19247   1.511  0.219
## Residuals         698 8890899   12738</code></pre>
<p>Now we can see that the p-value is greater than an alpha of .05, so we fail to reject the null hypothesis that verbal SAT scores are equal across levels of education.</p>
<p>We might neaten up our code a bit by using the <code>data</code> argument to specify the data frame that our variables belong to. This allows us to just use the column names in the formula object:</p>
<pre class="sourceCode r"><code class="sourceCode r">educ_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(SATV <span class="op">~</span><span class="st"> </span>education, <span class="dt">data=</span>sat.act)
<span class="kw">summary</span>(educ_aov)</code></pre>
<pre><code>##              Df  Sum Sq Mean Sq F value Pr(&gt;F)
## education     1   19247   19247   1.511  0.219
## Residuals   698 8890899   12738</code></pre>
</div>
<div id="two-way-anova" class="section level4">
<h4><span class="header-section-number">3.5.4.2</span> Two-way ANOVA</h4>
<p>To demonstrate a two-way ANOVA, imagine that we are curious as to whether quantitative SAT scores vary across levels of education and gender:</p>
<pre class="sourceCode r"><code class="sourceCode r">educ_gender_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(SATQ <span class="op">~</span><span class="st"> </span>education <span class="op">+</span><span class="st"> </span>gender, <span class="dt">data=</span>sat.act)
<span class="kw">summary</span>(educ_gender_aov)</code></pre>
<pre><code>##              Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
## education     1   10998   10998   0.845    0.358    
## gender        1  261978  261978  20.133 8.47e-06 ***
## Residuals   684 8900522   13012                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 13 observations deleted due to missingness</code></pre>
<p>The p-value for education is .358, so we fail to reject the null hypothesis that quantitative SAT scores are equal across levels of education. The p-value for gender, however, is approximately zero, so we can reject the null hypothesis that quantitative SAT scores are equal across genders. To determine which gender has the highest scores, you might have your students find the means or create a barplot.</p>
<p>The two-way ANOVA that we just ran assumed an additive model, but perhaps we think that the effect of gender on quantitative SAT scores is different across different levels of education. To test this hypothesis with the interactive model, change the <code>+</code> symbol between the independent variables to an <code>*</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">educ_gender_aov_int &lt;-<span class="st"> </span><span class="kw">aov</span>(SATQ <span class="op">~</span><span class="st"> </span>education <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data=</span>sat.act)
<span class="kw">summary</span>(educ_gender_aov_int)</code></pre>
<pre><code>##                   Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
## education          1   10998   10998   0.844    0.358    
## gender             1  261978  261978  20.111 8.57e-06 ***
## education:gender   1    3396    3396   0.261    0.610    
## Residuals        683 8897126   13027                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 13 observations deleted due to missingness</code></pre>
<p>The p-value for the interaction term is .610, so we fail to reject the null hypothesis that the effect of gender on quantitative SAT scores is the same across levels of education.</p>
</div>
</div>
<div id="cor.test" class="section level3">
<h3><span class="header-section-number">3.5.5</span> <code>cor.test()</code></h3>
<p>The <code>cor.test()</code> function can be used to test the significance of a correlation. The correlation is measured by Pearsons’s <span class="math inline">\(r\)</span> by default, but note that it can also be set to Kendall’s <span class="math inline">\(\tau\)</span> or Spearman’s <span class="math inline">\(\rho\)</span> with the <code>method</code> argument.</p>
<p>To demonstrate, imagine that we are curious as to whether verbal and quantitative SAT scores are linearly related:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(sat.act<span class="op">$</span>SATV, sat.act<span class="op">$</span>SATQ)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  sat.act$SATV and sat.act$SATQ
## t = 22.05, df = 685, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.5983352 0.6860379
## sample estimates:
##       cor 
## 0.6442999</code></pre>
<p>The p-value is essentially zero, so we can reject the null hypothesis that the correlation between verbal and quantitative SAT scores is zero. The estimate instead is .644, indicating a positive linear relationship.</p>
<p>This test was run with default parameter values for the alternative hypothesis and confidence level, which can be modified as follows:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>alternative</code></td>
<td align="left">Set to <code>two.sided</code> for a two-sided test, <code>less</code> for the lower tail, and <code>greater</code> for the upper tail; the default is <code>two.sided</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>conf.level</code></td>
<td align="left">Provide a number between 0 and 1 to specify the range for the confidence interval; the default is .95.</td>
</tr>
</tbody>
</table>
</div>
<div id="binom.test" class="section level3">
<h3><span class="header-section-number">3.5.6</span> <code>binom.test()</code></h3>
<p>The <code>binom.test()</code> function can be used to test the significance of a proportion calculated from a binary variable. The test assumes a null proportion of .5, but this can be modified with the <code>p</code> argument.</p>
<p>To demonstrate, imagine that we are curious as to whether there are more males than females reporting their test scores.</p>
<p>We first need to find the number of males and females in the data set, which we can do by creating a table of the <code>gender</code> variable:</p>
<pre class="sourceCode r"><code class="sourceCode r">gender_table &lt;-<span class="st"> </span><span class="kw">table</span>(sat.act<span class="op">$</span>gender)</code></pre>
<p>We can then call <code>binom.test()</code> on the table we created to test whether the proportion of males (the first category in the table) is significantly different from .5:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">binom.test</span>(gender_table)</code></pre>
<pre><code>## 
##  Exact binomial test
## 
## data:  gender_table
## number of successes = 247, number of trials = 700, p-value =
## 5.974e-15
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.3174274 0.3895333
## sample estimates:
## probability of success 
##              0.3528571</code></pre>
<p>The p-value is essentially zero, so we can reject the null hypothesis that the proportion of males is .5; instead, it seems there are more females than males.</p>
<p>Note that the same test can be run by specifying only the number of males in the first argument, then specifying the total number of observations (i.e., the number of rows in <code>sat.act</code>) using the <code>n</code> argument:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find the number of males</span>
n_males &lt;-<span class="st"> </span><span class="kw">length</span>(sat.act<span class="op">$</span>gender[sat.act<span class="op">$</span>gender<span class="op">==</span><span class="dv">1</span>])

<span class="co"># Run the binomial test</span>
<span class="kw">binom.test</span>(n_males, <span class="dt">n=</span><span class="kw">nrow</span>(sat.act))</code></pre>
<pre><code>## 
##  Exact binomial test
## 
## data:  n_males and nrow(sat.act)
## number of successes = 247, number of trials = 700, p-value =
## 5.974e-15
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.3174274 0.3895333
## sample estimates:
## probability of success 
##              0.3528571</code></pre>
<p>The first method is likely simpler if you are sticking to examples or assignments with real data, but the second method is more amenable to hypothetical scenarios, such as asking students to test whether a coin is fair if it produced 60 heads out of 100 flips.</p>
<p>This test was run with default parameter values for the alternative hypothesis and confidence level, which can be modified as follows:</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>alternative</code></td>
<td align="left">Set to <code>two.sided</code> for a two-sided test, <code>less</code> for the lower tail, and <code>greater</code> for the upper tail; the default is <code>two.sided</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>conf.level</code></td>
<td align="left">Provide a number between 0 and 1 to specify the range for the confidence interval; the default is .95.</td>
</tr>
</tbody>
</table>
</div>
<div id="chisq.test" class="section level3">
<h3><span class="header-section-number">3.5.7</span> <code>chisq.test()</code></h3>
<p>The <code>chisq.test()</code> function can be used to execute either a Chi-Square test for goodness-of-fit or a Chi-Square test of independence, determined by whether a table with one or two groups is supplied, respectively.</p>
<div id="chi-square-test-of-goodness-of-fit" class="section level4">
<h4><span class="header-section-number">3.5.7.1</span> Chi-Square test of Goodness-of-Fit</h4>
<p>To demonstrate the Chi-Square goodness-of-fit test, imagine that we are curious as to whether there are equal numbers of people in each education level measured in the <code>sat.act</code> data set.</p>
<p>We first need to find the number of respondents in each education level, which we can do by creating a table of the <code>education</code> variable:</p>
<pre class="sourceCode r"><code class="sourceCode r">educ_table &lt;-<span class="st"> </span><span class="kw">table</span>(sat.act<span class="op">$</span>education)</code></pre>
<p>We can then call <code>chisq.test()</code> on the table we created to test whether there are equal proportions of respondents in each education level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(educ_table)</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  educ_table
## X-squared = 343.66, df = 5, p-value &lt; 2.2e-16</code></pre>
<p>The p-value is approximately zero, so we can reject the null hypothesis that the proportions are equal. From the table, we can see that respondent are more likely than not to have recieved at least some higher education.</p>
<p>By default, the Chi-Square test of independence tests the null hypothesis that the proportions are equal across groups, but this can be changed by providing a vector of proportions to the <code>p</code> argument. For instance, imagine that we wanted to test whether the proportions were equal to those from respondents in a neighboring state, which were much less likely to have been educated past high school:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(educ_table, <span class="dt">p=</span><span class="kw">c</span>(.<span class="dv">25</span>, <span class="fl">.25</span>, <span class="fl">.125</span>, <span class="fl">.125</span>, <span class="fl">.125</span>, <span class="fl">.125</span>))</code></pre>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  educ_table
## X-squared = 661.41, df = 5, p-value &lt; 2.2e-16</code></pre>
<p>The p-value is approximately zero, so we can reject the null hypothesis that the proportions are the same as for the neighboring state.</p>
</div>
<div id="chi-square-test-of-independence" class="section level4">
<h4><span class="header-section-number">3.5.7.2</span> Chi-Square test of Independence</h4>
<p>To demonstrate the Chi-Square test of independence, imagine that we are curious as to whether the proportions of males and females reporting their test scores are equal across levels of education.</p>
<p>We first need to find the number of males and females in each level of education, which we can do by creating a table of the <code>gender</code> and <code>education</code> variables:</p>
<pre class="sourceCode r"><code class="sourceCode r">educ_gender_table &lt;-<span class="st"> </span><span class="kw">table</span>(sat.act<span class="op">$</span>education, sat.act<span class="op">$</span>gender)</code></pre>
<p>We can then call <code>chisq.test()</code> on the table we created to test whether there are equal proportions of males and females in each education level:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(educ_gender_table)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  educ_gender_table
## X-squared = 16.085, df = 5, p-value = 0.006605</code></pre>
<p>The p-value is .007, so we can reject the null hypothesis that level of education is independent of gender. Instead, gender seems to be more balanced in the lower education levels, whereas there are more females than males in the higher education levels.</p>
</div>
<div id="reproducibility-3" class="section level4 unnumbered">
<h4>Reproducibility</h4>
<p>The R session information when compiling this book is shown below:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 7 x64 (build 7601) Service Pack 1
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] psych_1.8.12
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.1      bookdown_0.11   lattice_0.20-35 packrat_0.4.9-3
##  [5] digest_0.6.19   grid_3.5.1      nlme_3.1-137    magrittr_1.5   
##  [9] evaluate_0.14   highr_0.7       stringi_1.4.3   rmarkdown_1.13 
## [13] tools_3.5.1     foreign_0.8-70  stringr_1.3.1   xfun_0.6       
## [17] parallel_3.5.1  compiler_3.5.1  mnormt_1.5-5    htmltools_0.3.6
## [21] knitr_1.22</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-programming-fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tools-advice-for-instructors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["PBS-R-Manual.pdf"],
"toc": {
"collapse": "none"
},
"toc_depth": 2
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
